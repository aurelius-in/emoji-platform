<!DOCTYPE html>
<html>
<head>
  <title>Emoji Platformer</title>
  <style>
    body { margin: 0; padding: 0; }
    canvas { border: 4px solid black; }
  </style>
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
</head>
<body>
  <canvas id="gameCanvas" width="3200" height="1440"></canvas>
  <script>
    screen.orientation.lock('landscape');
    const canvas = document.getElementById("gameCanvas");
    const ctx = canvas.getContext("2d");

    let gameState = 'selectCharacter', playerEmoji = null, scrollX = 0;
    let player = { x: 50, y: 960, width: 50, height: 50, vx: 10, vy: 0, gravity: 0.5, jump: -10, grounded: false, jumping: false };
    let platforms = [], animals = [], ramps = [];
    let touchStartX, touchStartY, touchEndX, touchEndY;

    canvas.addEventListener("touchstart", function(e) {
      e.preventDefault();
      const touch = e.touches[0];
      touchStartX = touch.clientX;
      touchStartY = touch.clientY;

      if (gameState === 'selectCharacter') {
        if (touch.clientX >= 600 && touch.clientX <= 900 && touch.clientY >= 400 && touch.clientY <= 700) {
          playerEmoji = "👨‍🦽";
          gameState = 'play';
        } else if (touch.clientX >= 1400 && touch.clientX <= 1700 && touch.clientY >= 400 && touch.clientY <= 700) {
          playerEmoji = "👩‍🦽";
          gameState = 'play';
        }
      }
    });

    canvas.addEventListener("touchend", function(e) {
      e.preventDefault();
      const touch = e.changedTouches[0];
      touchEndX = touch.clientX;
      touchEndY = touch.clientY;

      const deltaX = touchEndX - touchStartX;
      const deltaY = touchEndY - touchStartY;

      if (gameState !== 'selectCharacter') {
        if (Math.abs(deltaX) > Math.abs(deltaY)) {
          if (deltaX > 0) {
            player.x += 50;
          } else {
            player.x -= 50;
          }
        } else {
          if (deltaY < 0 && player.grounded) {
            player.vy = player.jump;
            player.grounded = false;
            player.jumping = true;
          }
        }
      }
    });

    platforms.push({ x: 0, y: 960, width: 500, height: 25 });
    player.y = platforms[0].y - player.height;

    const tinyAnimals = ["🐞", "🐛", "🦗", "🐜", "🐌"];
    const smallAnimals = ["🐈", "🐒", "🐕", "🦂", "🦔", "🦨", "🐢", "🦆", "🦤", "🐦", "🐓", "🐈‍⬛", "🐩", "🦫", "🦢"];
    const bigAnimals = ["🦍", "🦘", "🦓", "🐖", "🐃", "🐂", "🦏", "🦣", "🐐", "🐪", "🐫", "🐆", "🐅"];
    const hugeAnimals = ["🐘", "🦒", "🦖", "🐙"];
    const allAnimals = [...tinyAnimals, ...smallAnimals, ...bigAnimals, ...hugeAnimals];

    const generatePlatform = () => {
      const lastPlatform = platforms[platforms.length - 1] || { x: 0, y: 960, width: 500 };
      const newPlatform = {
        x: lastPlatform.x + lastPlatform.width + Math.floor(Math.random() * 200) + 100,
        y: Math.min(canvas.height - 50, Math.max(50, lastPlatform.y + Math.floor(Math.random() * 400) - 200)),
        width: Math.floor(Math.random() * 100) + 400,
        height: 25
      };
      platforms.push(newPlatform);

      const newRamp = {
        x1: lastPlatform.x + lastPlatform.width,
        y1: lastPlatform.y,
        x2: newPlatform.x,
        y2: newPlatform.y
      };
      ramps.push(newRamp);

      generateAnimal(newPlatform);
    };

    const generateAnimal = (platform) => {
      const animalEmoji = allAnimals[Math.floor(Math.random() * allAnimals.length)];
      const animalSize = tinyAnimals.includes(animalEmoji) ? 'tiny' : smallAnimals.includes(animalEmoji) ? 'small' : bigAnimals.includes(animalEmoji) ? 'big' : 'huge';
      const newAnimal = { emoji: animalEmoji, x: platform.x + platform.width / 2, y: platform.y - 50, size: animalSize };
      animals.push(newAnimal);
    };

    for (let i = 0; i < 20; i++) generatePlatform();
    player.y = platforms[0].y - player.height;

    const draw = () => {
      ctx.clearRect(0, 0, canvas.width, canvas.height);
      gameState === 'selectCharacter' ? drawCharacterSelection() : drawGame();
    };

    const drawCharacterSelection = () => {
      ctx.font = "300px Arial";
      ctx.fillText("👩‍🦽", 600, 700);
      ctx.font = "100px Arial";
      ctx.fillText("or", 1000, 700);
      ctx.font = "300px Arial";
      ctx.fillText("👨‍🦽", 1400, 700);
    };

    const drawGame = () => {
      ctx.font = "144px Arial";
      ctx.fillText(playerEmoji, player.x - scrollX, player.y);
      ctx.fillStyle = "#8B4513";
      platforms.forEach(platform => ctx.fillRect(platform.x - scrollX, platform.y, platform.width, platform.height));
      ramps.forEach(ramp => {
        ctx.beginPath();
        ctx.moveTo(ramp.x1 - scrollX, ramp.y1);
        ctx.lineTo(ramp.x2 - scrollX, ramp.y2);
        ctx.lineWidth = 25;
        ctx.stroke();
      });
      animals.forEach(animal => {
        ctx.font = animal.size === 'tiny' ? "50px Arial" : animal.size === 'small' ? "100px Arial" : animal.size === 'big' ? "200px Arial" : "300px Arial";
        ctx.fillText(animal.emoji, animal.x - scrollX, animal.y);
      });
    };

    const update = () => {
      if (gameState !== 'selectCharacter') {
        player.y += player.vy;
        player.vy += player.gravity;
        player.grounded = false;
        platforms.forEach(platform => {
          if (player.x < platform.x + platform.width && player.x + player.width > platform.x && player.y < platform.y + platform.height && player.y + player.height > platform.y) {
            player.y = platform.y - player.height;
            player.vy = 0;
            player.grounded = true;
            player.jumping = false;
          }
        });
        if (player.jumping) player.x += 15;
        scrollX = player.x - canvas.width / 2;
      }
    };

    const gameLoop = () => {
      update();
      draw();
      requestAnimationFrame(gameLoop);
    };

    gameLoop();
  </script>
</body>
</html>
