<!DOCTYPE html>
<html>
<head>
  <title>Emoji Platformer</title>
  <style>
    body {
      margin: 0;
      padding: 0;
    }
    canvas {
      border: 4px solid black;
    }
  </style>
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <script>
    // Lock screen to landscape mode
    screen.orientation.lock('landscape');
  </script>
</head>
<body>
  <canvas id="gameCanvas" width="3200" height="1440"></canvas>
  <script>
    
// Declare and load the background image at the top of your script
var backgroundImage = new Image();
backgroundImage.src = "jungle-bg3.png";
    
    var smallAnimals = ["🐈", "🐒", "🐕", "🦂", "🦔"];
    var bigAnimals = ["🦍", "🦘", "🦓", "🐖", "🐃", "🐂", "🦏"];
    var hugeAnimals = ["🐘", "🦒"];
    var allAnimals = smallAnimals.concat(bigAnimals, hugeAnimals);
    var animalIndex = 0;
    var animals = [];

    var platforms = [];
    var y = 960;
    var x = 0;


    var canvas = document.getElementById("gameCanvas");
    var ctx = canvas.getContext("2d");

    var gameState = 'selectCharacter';
    var playerEmoji = null;
    var scrollX = 0;

    var player = {
      x: 50,
      y: 960,
      width: 50,
      height: 50,
      vx: 10,
      vy: 0,
      gravity: 0.5,
      jump: -10,
      grounded: false,
      jumping: false
    };

// Initialize player's y-coordinate to be on the first platform
player.y = platforms[0].y - player.height;
    
// Initialize platforms
var centerPlatform = {
  x: canvas.width / 2 - 250,
  y: canvas.height / 2,
  width: 500,
  height: 25
};
platforms.push(centerPlatform);

for (var i = 1; i <= 4; i++) {
  platforms.push({
    x: centerPlatform.x - (i * 575),
    y: centerPlatform.y,
    width: 500,
    height: 25
  });
  platforms.push({
    x: centerPlatform.x + (i * 575),
    y: centerPlatform.y,
    width: 500,
    height: 25
  });
}
    
    function generatePlatform(direction) {
  var platformWidth = Math.floor(Math.random() * 101) + 400;  // Random width between 400 and 500
  var newPlatform = {
    x: direction === 'right' ? x : x - platformWidth - 75,
    y: y,
    width: platformWidth,
    height: 25
  };
  platforms.push(newPlatform);

  // Generate a random animal
  var animal = allAnimals[Math.floor(Math.random() * allAnimals.length)];
  var animalSize = smallAnimals.includes(animal) ? 'small' : (bigAnimals.includes(animal) ? 'big' : 'huge');
  animals.push({
    x: newPlatform.x + platformWidth / 2,
    y: newPlatform.y - 50,
    emoji: animal,
    size: animalSize
  });

  // Update x and y for the next platform
  x = direction === 'right' ? x + platformWidth + 75 : x - platformWidth - 75;
  y += Math.random() < 0.5 ? 100 : -100;
  if (y < canvas.height * 1 / 3) {
    y = canvas.height * 1 / 3;
  }
}

for (var i = 0; i < 20; i++) {
  generatePlatform();
}

// Lock screen to landscape mode
window.addEventListener("DOMContentLoaded", (event) => {
  screen.orientation.lock('landscape');
});

function draw() {
  // Clear the screen
  ctx.clearRect(0, 0, canvas.width, canvas.height);

  // Draw the background image
  var scaledWidth = canvas.height * 6;
  ctx.drawImage(backgroundImage, 0, 0, backgroundImage.width, backgroundImage.height, -scrollX, 0, scaledWidth, canvas.height);
  
      if (gameState === 'selectCharacter') {
        ctx.font = "300px Arial";
        ctx.fillText("💃", 600, 700);
        ctx.font = "100px Arial";
        ctx.fillText("or", 1000, 700);
        ctx.font = "300px Arial";
        ctx.fillText("🕺", 1400, 700);
      } else {
        // Draw player
        ctx.font = "144px Arial";
        ctx.fillText(playerEmoji, player.x - scrollX, player.y);

        // Draw platforms
        ctx.fillStyle = "#8B4513";
        platforms.forEach(function(platform) {
          ctx.fillRect(platform.x - scrollX, platform.y, platform.width, platform.height);
        });

        // Draw animals
        animals.forEach(function(animal) {
          ctx.font = animal.size === 'small' ? "100px Arial" : (animal.size === 'big' ? "200px Arial" : "300px Arial");
          ctx.fillText(animal.emoji, animal.x - scrollX, animal.y);
        });
      }
    }

function update() {
  if (gameState !== 'selectCharacter') {
    // Gravity
    player.y += player.vy;
    player.vy += player.gravity;
    player.grounded = false;

    // Collision with platforms
    platforms.forEach(function(platform) {
      if (player.x < platform.x + platform.width &&
          player.x + player.width > platform.x &&
          player.y < platform.y + platform.height &&
          player.y + player.height > platform.y) {
        player.y = platform.y - player.height;
        player.vy = 0;
        player.grounded = true;
        player.jumping = false;  // Reset jumping flag when player lands
      }
    });

    // Move player forward only when jumping
    if (player.jumping) {
    player.x += 15;  // Reduce this for shorter jumps
  }

    // Center the screen on the player
    scrollX = player.x - canvas.width / 2;
  }
// Check if the player is close to the right edge of the screen
  if (player.x - scrollX > canvas.width - 200) {
    generatePlatform('right');
  }

  // Check if the player is close to the left edge of the screen
  if (player.x - scrollX < 200) {
    generatePlatform('left');
  }
}

canvas.addEventListener("touchstart", function(e) {
  e.preventDefault();
  var touch = e.touches[0];
  if (gameState === 'selectCharacter') {
    if (touch.clientX >= 600 && touch.clientX <= 900 && touch.clientY >= 400 && touch.clientY <= 1000) {
      ctx.strokeRect(590, 400, 310, 300);
      setTimeout(() => {
        playerEmoji = '\ud83d\udc83';
        gameState = 'play';
      }, 500);
    } else if (touch.clientX >= 1400 && touch.clientX <= 1700 && touch.clientY >= 400 && touch.clientY <= 1000) {
      ctx.strokeRect(1390, 400, 310, 300);
      setTimeout(() => {
        playerEmoji = '\ud83d\udd7a';
        gameState = 'play';
      }, 500);
    }
  } else {
    // Game touch logic for hopping forward or backward
    if (player.grounded) {
      player.vy = player.jump;
      player.grounded = false;
      player.jumping = true;  // Set jumping flag when player jumps

      // Determine direction based on tap position
      if (touch.clientX > canvas.width / 2) {
        player.vx = 10;  // Jump right
      } else {
        player.vx = -10;  // Jump left
      }
    }
  }
});



    function gameLoop() {
      update();
      draw();
      requestAnimationFrame(gameLoop);
    }

    gameLoop();
  </script>
</body>
</html>
